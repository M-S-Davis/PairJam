<%- include('partials/_header.ejs') %> <%- include('partials/_navbar.ejs') %>
<main>
  <!-- Band General Info -->
  <h1 class="center">Welcome to <%= band.bandName %></h1>
  <div class="container">
    <img class="responsive-img circle" src="<%=band.logo%>" alt="" />
    <div class="card grey">
      <h2>About us</h2>
      <p><%= band.bandDesc %></p>
    </div>
  </div>
  <!-- The Band Members -->
  <div class="container center">
    <ul>
      <div class="container">
        <h3>Lineup</h3>
        <!-- Modal button -->
        <a
          class="waves-effect waves-light btn-floating modal-trigger"
          href="#addMember"
          ><i class="material-icons">add</i></a
        >
        <!-- Start of modal -->
        <div id="addMember" class="modal">
          <div class="modal-content">
            <h2>Add Band Member</h2>
            <div class="row">
              <div class="card">
                <form class="col s12" action="/bands/addMember/<%=band._id%>?_method=PUT" method="POST">
                  <!-- googleId -->
                  <div class="row">
                    <p>Please insert the GoogleID of the person you wish to join the band.</p>
                    <div class="input-field col s6">
                      <i class="material-icons prefix">account_circle</i>
                      <input
                        type="text"
                        id="googleId"
                        name="googleId"
                        class="validate"
                      />
                      <label for="googleId">Goolge ID</label>
                    </div>        
                  <!-- Submit button -->
                  <div class="row">
                    <button
                      class="btn waves-effect waves-light"
                      type="submit"
                      name="action"
                    >
                      Submit
                      <i class="material-icons right">send</i>
                    </button>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat"
              >Close</a
            >
          </div>
        </div>
        <!-- End of modal -->
      </div>

      <div class="container">
        <% for (let i = 0; i < members.length; i++) { %>
        <li>
          Band Member: <%= memberNames[i] %> <%= members[i] %> <% if(band.createdByGoogleId ==
          user.googleId) { %>
          <form
            action="/bands/deleteMember/?id=<%=band._id%>?member=<%=members[i]%>?_method=DELETE"
            method="POST"
          >
            <input type="hidden" name="_method" value="DELETE" />
            <button class="btn right" method="POST">
              <i class="material-icons">delete</i>
            </button>
          </form>
          <% } %>
        </li>
        <% } %>
      </div>
    </ul>
  </div>
  <!-- The Band Member's Songs -->
  <div class="song-list-conatiner">
    <% for(var i=0; i < songs.length; i++) { %>
    <div class="container card hoverable">
      <ul class="collection s6">
        <li class="collection-item avatar">
          <img src="<%= songs[i].image%>" alt="" class="circle" />
          <span class="title truncate"><%= songs[i].songName %></span>
          <p class="truncate"><%= songs[i].artistName %></p>
          <p class="truncate"><%= songs[i].note %></p>

          <!-- If user created this song, display additonal content -->
          <% if(songs[i].createdByGoogleId == user.googleId) { %>
          <a
            href="/songs/editSong/<%=songs[i]._id%>"
            class="right secondary-content"
            ><i class="material-icons">edit</i></a
          >
          <form
            action="/songs/deleteSong/<%=songs[i]._id%>?_method=DELETE"
            method="POST"
          >
            <input type="hidden" name="_method" value="DELETE" />
            <button class="btn right" method="POST">
              <i class="material-icons">delete</i>
            </button>
          </form>
          <% } %>
        </li>
      </ul>
    </div>
    <% } %>
  </div>
</main>
<%- include('partials/_footer.ejs') %>
